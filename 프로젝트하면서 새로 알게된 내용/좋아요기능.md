# ğŸ’¡ Articleê³¼ LikeëŠ” ë¬´ìŠ¨ ê´€ê³„ì¼ê¹Œ?
## í•œ ê²Œì‹œê¸€ì€ ì—¬ëŸ¬ëª…ì—ê²Œ ì¢‹ì•„ìš”ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤. ë˜í•œ í•œ ì‚¬ëŒì€ ì—¬ëŸ¬ê°œì˜ ê²Œì‹œê¸€ì— ì¢‹ì•„ìš”ë¥¼ í•  ìˆ˜ ìˆë‹¤. ì¦‰, Articleê³¼ Like_userëŠ” N:N ê´€ê³„ë¥¼ ê°€ì§„ë‹¤.

# ğŸ”§ ì¢‹ì•„ìš” ê¸°ëŠ¥ êµ¬í˜„í•˜ê¸°

## 1. articles/models.py
### ''ìœ ì €ëŠ” ê²Œì‹œê¸€ì„ ì¢‹ì•„í•œë‹¤.'' ì—¬ê¸°ì„œ tableì€ ìœ ì € í…Œì´ë¸”ê³¼ ê²Œì‹œê¸€ í…Œì´ë¸”ì´ ì‚¬ìš©ë˜ê³  ì¤‘ê°„ì— ì¢‹ì•„ìš”ë¼ëŠ” í–‰ìœ„ê°€ ì¤‘ê°œí…Œì´ë¸”ì´ ëœë‹¤. ê·¸ë˜ì„œ `Article model`ì— `user í…Œì´ë¸”`ê³¼ ì—°ê²°í•˜ëŠ” like_usersë¼ëŠ” ì´ë¦„ì˜ `manytomany` í•„ë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
### ì´ë•Œ, ê¼­! `related_name`ì„ ì„¤ì •í•´ì¤˜ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ê²Œì‹œê¸€ì„ ì‘ì„±í•œ ìœ ì €ë¥¼ ë‚˜íƒ€ë‚´ëŠ” `user í•„ë“œ`ì˜ ë§¤ë‹ˆì €ì™€ ì¶©ëŒí•˜ê²Œ ëœë‹¤. ë‘˜ë‹¤ user í…Œì´ë¸”ê³¼ ì—°ê²°ëœ í•„ë“œì´ê¸° ë•Œë¬¸ì— managerê°€ user_setìœ¼ë¡œ í‘œí˜„ëœë‹¤. ê·¸ë ‡ê¸° ë•Œë¬¸ì— related_nameì„ ì¨ì„œ manager ì¶©ëŒì„ ë§‰ì•„ì£¼ì.

```# articles/models.py
from django.db import models
from django.conf import settings

# Create your models here.
class Article(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE)
    like_users = models.ManyToManyField(settings.AUTH_USER_MODEL, related_name='like_articles')
    title = models.CharField(max_length=10)
    content = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.title
```

## 2. migrations & migrate
### DB í…Œì´ë¸”ì„ ë³€ê²½í•´ì¤¬ìœ¼ë‹ˆ migrateëŠ” í•„ìˆ˜!!
```
python manage.py migrations
python manage.py migrate
```

## 3. articles/urls.py
### ì¢‹ì•„ìš”ë¥¼ ì¶”ê°€í•˜ê³  ì‚­ì œí•  ë•Œ ì“°ì´ëŠ” urlì„ ë§Œë“¤ì–´ì¤€ë‹¤.
```
from django.urls import path
from . import views


app_name = 'articles'
urlpatterns = [
    # ìƒëµ
    path('<int:article_pk>/likes/', views.likes, name='likes'),
]
```

## 4. articles.views.py
### ë¡œê·¸ì¸ì´ ëœ ìœ ì €ì¼ë•Œë§Œ ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ ì´ìš©í•  ìˆ˜ ìˆë‹¤. ë§Œì•½ ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ í˜„ì¬ ìœ ì €ê°€ í•´ë‹¹ ê²Œì‹œê¸€ì„ ì¢‹ì•„ìš”í•œ ì‚¬ëŒ ì¤‘ í•œëª…ì´ë¼ë©´ ì¢‹ì•„ìš”ë¥¼ ì·¨ì†Œí•˜ê³ , ì•„ì§ ì¢‹ì•„ìš”ë¥¼ í•˜ì§€ ì•Šì•˜ë‹¤ë©´ ì¢‹ì•„ìš” í•œ ì‚¬ëŒì— í˜„ì¬ ìœ ì €ë¥¼ ì¶”ê°€í•œë‹¤.

## ğŸ“Œ article.like_users.filter(pk=request.user.pk).exists()
### í•´ë‹¹ ê²Œì‹œê¸€ì„ ì¢‹ì•„ìš”í•œ ì‚¬ëŒì¤‘ì— pkê°€ í˜„ì¬ ìœ ì €ì˜ pkë‘ ê°™ì€ ê²ƒì´ ì¡´ì¬í•˜ëŠ”ì§€ í•˜ì§€ ì•ŠëŠ”ì§€ë¥¼ íŒë‹¨í•œë‹¤. request.user.like_articles.(pk=article_pk).exist() ë¼ê³  ì¨ë„ ê°™ì€ ëœ»ì´ ëœë‹¤.
```
@require_POST
def likes(request, article_pk):
    if request.user.is_authenticated:
        article = get_object_or_404(Article, pk=article_pk)

        if article.like_users.filter(pk=request.user.pk).exists():
            article.like_users.remove(request.user)
        else:
            article.like_users.add(request.user)
        return redirect('articles:index')
    return redirect('accounts:login')
```

## 5. templates
### ì›í•˜ëŠ” í…œí”Œë¦¿ì— ì¢‹ì•„ìš” ë²„íŠ¼ì„ ë„£ì–´ì¤€ë‹¤. í˜„ì¬ ìœ ì €ê°€ ì¢‹ì•„ìš”ë¥¼ ì´ë¯¸ í•œ ìƒíƒœë¼ë©´ 'ì¢‹ì•„ìš” ì·¨ì†Œ' ê¸€ì”¨ë¥¼ ì¶œë ¥í•˜ê³ , ì•„ë‹ˆë¼ë©´ 'ì¢‹ì•„ìš”' ê¸€ì”¨ë¥¼ ì¶œë ¥í•œë‹¤.
```
<div>
  <form action="{% url 'articles:likes' article.pk %}" method='POST'>
    {% csrf_token %}
    {% if user in article.like_users.all %}
      <input type="submit" value='ì¢‹ì•„ìš” ì·¨ì†Œ'>
    {% else %}
      <input type="submit" value='ì¢‹ì•„ìš”'>
    {% endif %}
  </form>
</div>
```